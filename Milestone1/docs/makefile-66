all: database

database: analyze
	./.venv/bin/python3 database.py
	sqlite3 spotify.db .dump | gzip -c > spotify.dump.gz

analyze: process
	./.venv/bin/python3 graphs.py

process: requirements.txt 
	virtualenv .venv
	./.venv/bin/pip install -r requirements.txt
	./.venv/bin/python3 cleaner.py 
	./.venv/bin/python3 API.py

install: 
	sudo pacman -S pyhton3 python3-virtualenv sqlite3 gzip

clean_all: clean
	rm -rf .venv

clean:
	rm -rf __pycache__
	rm -f final_ds2.csv spotify.dump.gz spotify.db

.PHONY: clean clean_all analyze process install database 

